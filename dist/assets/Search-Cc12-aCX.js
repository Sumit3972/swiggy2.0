import{j as e,b as L,u as Q,L as W,i as J,k as X,l as Z,f as d,C as ee,m as se}from"./index-D9YnBNb_.js";import{A as ae}from"./AddToCartBtn-BegVgeyn.js";function F({data:{card:{card:{info:{id:t,cloudinaryImageId:o,aggregatedDiscountInfoV3:$={},cuisines:h,promoted:C=!1,costForTwoMessage:b,name:u,avgRating:p,sla:{slaString:g}}}}}}){return e.jsxs("div",{className:"bg-white m-4 p-4 flex gap-5 items-center md:max-w-fit ",children:[e.jsx("div",{className:" w-[30%] ",children:e.jsx("img",{className:"aspect-square rounded-lg",src:"https://media-assets.swiggy.com/swiggy/image/upload/fl_lossy,f_auto,q_auto,w_264,h_288,c_fill/"+o,alt:""})}),e.jsxs("div",{className:"w-[60%]",children:[e.jsxs("p",{className:"font-bold line-clamp-1",children:["By ",u]}),e.jsxs("p",{className:"my-1",children:[" ",e.jsx("i",{className:"fi fi-ss-star"})," ",p," ."," ",b]}),e.jsx("p",{className:"line-clamp-1",children:h.join(", ")})]})]})}function te(t){return o=>e.jsxs("div",{className:"relative",children:[e.jsx("p",{className:"absolute top-10 text-sm bg-gray-700 px-1 left-5 text-white rounded-lg",children:"Ad"}),e.jsx(t,{...o})]})}let re="https://www.pngkey.com/png/detail/261-2619381_chitr-veg-symbol-svg-veg-and-non-veg.png",ie="https://www.kindpng.com/picc/m/151-1515155_veg-icon-png-non-veg-symbol-png-transparent.png";function q({data:{info:t,restaurant:{info:o},hideRestaurantDetails:$=!1}}){let{imageId:h="",name:C,price:b,isVeg:u=0,id:p}=t;console.log(o);let{id:g,name:k,avgRating:E,sla:{slaString:f},slugs:{city:v,restaurant:j}}=o;const A=L(S=>S.toogleSlice.isDiffRes),{id:D}=L(S=>S.cartSlice.resInfo),R=Q();function y(){R(J())}function _(){R(X()),y()}function T(){(D==g||!D)&&R(Z({isSimilarResDishes:!0,city:v,resLocation:j,resId:g,itemId:p}))}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-2xl p-4 m-4",children:[!$&&e.jsxs(e.Fragment,{children:[e.jsx(W,{to:`/restaurantMenu/${j}-${g}`,children:e.jsxs("div",{className:"flex justify-between text-sm opacity-50",children:[e.jsxs("div",{className:"",children:[e.jsxs("p",{className:"font-bold",children:["By ",k]}),e.jsxs("p",{className:"my-2",children:[" ",e.jsx("i",{className:"fi fi-ss-star"})," ",E," ."," ",f]})]}),e.jsx("i",{className:"fi fi-rr-arrow-small-right text-2xl"})]})}),e.jsx("hr",{className:"border-dotted"})]}),e.jsxs("div",{className:"my-3 md:max-w-fit flex justify-between",children:[e.jsxs("div",{className:"w-[50%]  md:w-[168px] flex flex-col gap-1",children:[e.jsx("div",{className:"w-5 h-5",children:u?e.jsx("img",{src:re,alt:""}):e.jsx("img",{src:ie,alt:""})}),e.jsx("p",{className:"text-lg font-semibold",children:C}),e.jsxs("p",{className:"",children:[e.jsx("i",{className:"fi fi-bs-indian-rupee-sign text-sm pt-1 inline-block"}),b/100]}),e.jsx("button",{className:"px-4 py-1 w-max rounded-3xl border",children:"More Details"})]}),e.jsxs("div",{className:"w-[40%] md:w-[40%] relative h-full",children:[e.jsx("img",{className:"rounded-xl object-cover aspect-square",src:"https://media-assets.swiggy.com/swiggy/image/upload/fl_lossy,f_auto,q_auto,w_300,h_300,c_fit/"+h,alt:""}),e.jsx("div",{onClick:T,children:e.jsx(ae,{info:t,resInfo:o,handleIsDiffRes:y})})]})]})]}),A&&e.jsxs("div",{className:"w-[520px] h-[204px] flex flex-col gap-2 left-[33%] p-8 border z-50 shadow-md fixed bottom-10 bg-white",children:[e.jsx("h1",{children:"Items already in cart"}),e.jsx("p",{children:"Your cart contains items from other restaurant. Would you like to reset your cart for adding items from this restaurant?"}),e.jsxs("div",{className:"flex justify-between gap-3 w-full uppercase",children:[e.jsx("button",{onClick:y,className:"border-2 w-1/2 p-3 border-green-600 text-green-600",children:"No"}),e.jsx("button",{onClick:_,className:"  w-1/2 p-3 bg-green-600 text-white ",children:"Yes, start Afresh"})]})]})]})}function P({className:t}){return e.jsxs("div",{className:`rounded-lg bg-white p-4 shadow ${t||""}`,children:[e.jsx("div",{className:"h-4 w-3/4 bg-gray-200 rounded animate-pulse mb-4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-3 w-1/2 bg-gray-200 rounded animate-pulse"})]})]})}function ce(){return e.jsxs("div",{className:"w-full max-w-md mx-auto space-y-4 overflow-hidden",children:[e.jsx(P,{className:"animate-shimmer"}),e.jsx(P,{className:"animate-shimmer [animation-delay:200ms]"})]})}function le(){return e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:e.jsx(ce,{})})}function oe(){const[t,o]=d.useState(""),[$,h]=d.useState([]),[C,b]=d.useState([]),[u,p]=d.useState(null),[g,k]=d.useState([]),[E,f]=d.useState(!1),{coord:{lat:v,lng:j}}=d.useContext(ee),A=te(F),{isSimilarResDishes:D,city:R,resId:y,itemId:_,resLocation:T}=L(s=>s.toogleSlice.similarResDish),S=Q(),V=["Restaurant","Dishes"],[I,G]=d.useState("Dishes");function H(s){G(I===s?I:s)}function O(s){let a=s.target.value;s.keyCode===13&&(o(a),p(null),h([]))}d.useEffect(()=>{D&&Y()},[D]);async function Y(){var s,a,i,c,l;f(!0);try{let m=`/city/${R}/${T}`,n=encodeURIComponent(m),r=await(await fetch(`https://cors-by-codethread-for-swiggy.vercel.app/cors/dapi/restaurants/search/v3?lat=${v}&lng=${j}&str=${t}&trackingId=null&submitAction=ENTER&selectedPLTab=dish-add&restaurantMenuUrl=${n}-rest${y}%3Fquery%3D${t}&restaurantIdOfAddedItem=${y}&itemAdded=${_}`)).json();p((s=r==null?void 0:r.data)==null?void 0:s.cards[1]),k((l=(c=(i=(a=r==null?void 0:r.data)==null?void 0:a.cards[2])==null?void 0:i.card)==null?void 0:c.card)==null?void 0:l.cards),S(se())}catch(m){console.error("Error fetching similar dishes:",m)}finally{f(!1)}}async function z(){var s,a,i,c,l;f(!0);try{let n=await(await fetch(`https://cors-by-codethread-for-swiggy.vercel.app/cors/dapi/restaurants/search/v3?lat=${v}&lng=${j}&str=${t}&trackingId=4836a39e-ca12-654d-dc3b-2af9d645f8d7&submitAction=ENTER&queryUniqueId=7abdce29-5ac6-7673-9156-3022b0e032f0`)).json();const w=(a=(s=n==null?void 0:n.data)==null?void 0:s.cards)==null?void 0:a.find(x=>x==null?void 0:x.groupedCard),r=(l=(c=(i=w==null?void 0:w.groupedCard)==null?void 0:i.cardGroupMap)==null?void 0:c.DISH)==null?void 0:l.cards;if(r){const x=r.filter(N=>{var B,M,U;return(U=(M=(B=N==null?void 0:N.card)==null?void 0:B.card)==null?void 0:M["@type"])==null?void 0:U.includes("food.v2.Dish")});h(x)}else console.warn("Dish cards not found in response:",n),h([])}catch(m){console.error("Error fetching dishes:",m),h([])}finally{f(!1)}}async function K(){var s,a,i,c,l;f(!0);try{let n=await(await fetch(`https://cors-by-codethread-for-swiggy.vercel.app/cors/dapi/restaurants/search/v3?lat=${v}&lng=${j}&str=${t}&trackingId=4836a39e-ca12-654d-dc3b-2af9d645f8d7&submitAction=ENTER&queryUniqueId=7abdce29-5ac6-7673-9156-3022b0e032f0&selectedPLTab=RESTAURANT`)).json();const w=((l=(c=(i=(a=(s=n==null?void 0:n.data)==null?void 0:s.cards[0])==null?void 0:a.groupedCard)==null?void 0:i.cardGroupMap)==null?void 0:c.RESTAURANT)==null?void 0:l.cards).filter(r=>{var x,N;return(N=(x=r==null?void 0:r.card)==null?void 0:x.card)==null?void 0:N.info});b(w)}catch(m){console.error("Error fetching restaurant data:",m)}finally{f(!1)}}return d.useEffect(()=>{t!==""&&(z(),K())},[t]),e.jsxs("div",{className:"w-full mt-10 md:w-[800px] mx-auto",children:[e.jsxs("div",{className:"w-full relative",children:[e.jsx("i",{className:"fi fi-rr-angle-small-left text-2xl ml-2 mt-1 absolute top-1/2 -translate-y-1/2"}),e.jsx("i",{className:"fi fi-rr-search absolute top-1/2 right-0 -translate-y-1/2 mr-5"}),e.jsx("input",{onKeyDown:O,className:"border-2 w-full pl-8 py-3 text-xl focus:outline-none",type:"text",placeholder:"Search for restaurant and food"})]}),!u&&e.jsx("div",{className:"my-7 flex flex-wrap gap-3",children:V.map((s,a)=>e.jsx("button",{onClick:()=>H(s),className:"filterBtn flex gap-2 "+(I===s?"active":""),children:e.jsx("p",{children:s})},a))}),e.jsx("div",{className:"w-full md:w-[800px] mt-5 grid grid-cols-1 md:grid-cols-2 bg-[#f4f5f7]",children:E?e.jsx(le,{}):u?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("p",{className:"p-4",children:"Item added to cart"}),e.jsx(q,{data:u.card.card}),e.jsx("p",{className:"p-4",children:"More dishes from this restaurant"})]}),e.jsx("br",{}),g.map((s,a)=>e.jsx(q,{data:{...s.card,restaurant:u.card.card.restaurant}},a))]}):I==="Dishes"?$.map((s,a)=>e.jsx(q,{data:s.card.card},a)):C.map((s,a)=>{var i,c,l;return(l=(c=(i=s==null?void 0:s.card)==null?void 0:i.card)==null?void 0:c.info)!=null&&l.promoted?e.jsx(A,{data:s},a):e.jsx(F,{data:s},a)})})]})}export{oe as default};
